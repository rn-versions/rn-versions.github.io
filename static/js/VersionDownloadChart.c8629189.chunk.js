(globalThis.webpackChunkrn_version_tracker=globalThis.webpackChunkrn_version_tracker||[]).push([[295],{7119:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>U});var i=n(2791),o=n(6699),a=n.n(o);const s={minLuminance:.2},r={maxLuminance:.4},l={saturation:.5,defaultLightness:.5},u={saturation:.7,defaultLightness:.6};const c={};function d(e,t){var n;const i=null!==(n=c[e])&&void 0!==n?n:[];for(const s of i)if(s.targetLuminance===(null===t||void 0===t?void 0:t.targetLuminance)&&s.variant===(null===t||void 0===t?void 0:t.variant))return s.result;const o="dark"===(null===t||void 0===t?void 0:t.variant)?l.saturation:u.saturation,a=`hsl(${e}, ${100*o}%, ${100*function(e,t,n,i){if("contrasts-light"===i)for(;m(t,n,e)>r.maxLuminance;)e-=.02;else if("contrasts-dark"===i)for(;m(t,n,e)<s.minLuminance;)e+=.02;return e}("dark"===(null===t||void 0===t?void 0:t.variant)?l.defaultLightness:u.defaultLightness,e,o,null===t||void 0===t?void 0:t.targetLuminance)}%)`;return i.push({variant:null===t||void 0===t?void 0:t.variant,targetLuminance:null===t||void 0===t?void 0:t.targetLuminance,result:a}),a}function v(e,t){const n=Math.abs(e-t)%1;return n>.5?1-n:n}function m(e,t,n){const{r:i,g:o,b:a}=function(e,t,n){const i=(1-Math.abs(2*n-1))*t,o=i*(1-Math.abs(e/60%2-1)),a=n-i/2;let s=0,r=0,l=0;e<60?(s=i,r=o,l=0):e<120?(s=o,r=i,l=0):e<180?(s=0,r=i,l=o):e<240?(s=0,r=o,l=i):e<300?(s=o,r=0,l=i):(s=i,r=0,l=o);return{r:Math.round(255*(s+a)),g:Math.round(255*(r+a)),b:Math.round(255*(l+a))}}(e,t,n);return.2126*h(i/255)+.7152*h(o/255)+.0722*h(a/255)}function h(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}const f=function(){let{theme:e,unit:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{areaChart:{margin:{top:15,right:28,bottom:5}},area:{type:"basis",isAnimationActive:!1,stroke:null!==e&&void 0!==e&&e.isInverted?e.palette.whiteTranslucent40:null===e||void 0===e?void 0:e.palette.blackTranslucent40},responsiveContainer:{width:"100%",height:260},grid:{stroke:null!==e&&void 0!==e&&e.isInverted?e.palette.whiteTranslucent40:null===e||void 0===e?void 0:e.palette.blackTranslucent40,strokeDasharray:"1 1"},xAxis:{tickLine:!1,tick:{fill:null===e||void 0===e?void 0:e.semanticColors.bodyText}},yAxis:{tickLine:!1,tickMargin:10,tickSize:0,tickCount:5,width:56,tick:{fill:null===e||void 0===e?void 0:e.semanticColors.bodyText}},tooltip:{animationDuration:150,animationEasing:"linear",offset:24}}},g="VersionTooltip_frame__mZVBJ",p="VersionTooltip_date__ejKCx",x="VersionTooltip_versionsList__tB7yN",k="VersionTooltip_versionsListItem__HAZpv",L="VersionTooltip_versionLabel__eA66Q",j="VersionTooltip_versionCount__0B822";var _=n(9127),b=n(3153),y=n(239),C=n(184);const N=e=>{let{label:t,payload:n,unit:i,versionHues:o,theme:a}=e;const s=[...null!==n&&void 0!==n?n:[]];return s.reverse(),(0,C.jsx)(_.N.Consumer,{children:e=>{var n,r,l;a=null!==(n=a)&&void 0!==n?n:e;const u=s.length>0&&(0,C.jsxs)("ul",{className:x,children:[s.map(((e,t)=>{const n=a?d(o[e.name],a.isInverted?{variant:"dark",targetLuminance:"contrasts-dark"}:{variant:"light",targetLuminance:"contrasts-light"}):e.color,s=function(e,t,n){const{versionCounts:i}=t.payload,o=e/Object.values(i).reduce(((e,t)=>e+t),0)*100;return"percentage"===n?Math.round(100*o)/100+"%":`${e.toLocaleString()} (${Math.round(o)}%)`}(e.value,e,i);return(0,C.jsxs)("li",{className:k,children:[(0,C.jsx)(b.x,{variant:"small",className:L,style:{color:n},children:e.name}),(0,C.jsx)(b.x,{variant:"small",className:j,children:s})]},t)})),(0,C.jsxs)("li",{className:k,children:[(0,C.jsx)(b.x,{variant:"small",className:L,children:"Total"}),(0,C.jsx)(b.x,{variant:"small",className:j,children:s.reduce(((e,t)=>e+(t.value||0)),0).toLocaleString()})]},"sum")]});return(0,C.jsxs)(y.f,{theme:a,className:g,style:{backgroundColor:null===(r=null!==(l=a)&&void 0!==l?l:e)||void 0===r?void 0:r.semanticColors.bodyBackground},children:[(0,C.jsx)(b.x,{className:p,variant:"medium",children:(c=t,new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric"}))}),u]});var c}})};var T=n(601),S=n(5163),M=n(466),H=n(2891),w=n(5667),V=n(4296),D=n(2955),I=n(2839),A=n(4164);const B="VersionLegend_versionsListContainer__vCxx0",$="VersionLegend_versionsList__tRQMP",O="VersionLegend_versionsListItem__f1GBC",K="VersionLegend_versionColorIndicator__BpNMr",F="VersionLegend_versionLabel__FNwLX",E=e=>{let{payload:t,versionHues:n,hiddenSeries:i,setHiddenSeries:o}=e;return(0,C.jsx)(_.N.Consumer,{children:e=>(0,C.jsx)("div",{className:B,children:(0,C.jsx)("ul",{className:$,children:t.map((t=>{let{value:a,color:s}=t;const r=i.includes(a),l=r?null===e||void 0===e?void 0:e.semanticColors.buttonBackgroundDisabled:e?d(n[a],e.isInverted?{variant:"dark",targetLuminance:"contrasts-dark"}:{variant:"light",targetLuminance:"contrasts-light"}):s;return(0,C.jsxs)("li",{className:O,onClick:()=>o((()=>r?i.filter((e=>e!==a)):i.concat(a))),children:[(0,C.jsx)("div",{className:K,style:{backgroundColor:l}}),(0,C.jsx)(b.x,{variant:"small",className:F,style:r?{color:null===e||void 0===e?void 0:e.semanticColors.buttonTextDisabled}:{},children:a})]},a)}))})})})};function P(e){return e?e>=1e6?`${(e/1e6).toLocaleString()} m`:e>=1e3?`${(e/1e3).toLocaleString()} k`:e.toLocaleString():""}function Q(e,t){const n={};for(const o of e.points)if(o.date>=t)for(const[e,t]of Object.entries(o.versionCounts)){var i;const o=null!==(i=n[e])&&void 0!==i?i:0;n[e]=o+t}return n}const U=e=>{var t;let{className:n,history:o,maxDaysShown:s,maxVersionsShown:r,popularDuring:l,showLegend:u,showTooltip:c,unit:m,versionLabeler:h,theme:g,tooltipTheme:p}=e;const x=f({theme:g,unit:m}),[k,L]=(0,i.useState)(),[j,_]=(0,i.useState)([]),b=i.useMemo((()=>function(e,t,n,i){if(!e||0===e.points.length)return e;const o=e.points[e.points.length-1].date,a=new Date(o).setHours(0,0,0,0)-24*n*60*60*1e3,s=Q(e,"most-recent"===i?o:a),r=new Set(Object.entries(s).sort(((e,t)=>e[1]-t[1])).slice(-t).map((e=>{let[t,n]=e;return t}))),l=[];for(const u of e.points)if(u.date>=a){const e=Object.keys(u.versionCounts).filter((e=>r.has(e)));if(e.length>0){const t={date:u.date,versionCounts:{}};for(const n of e)t.versionCounts[n]=u.versionCounts[n];l.push(t)}}return{versions:e.versions.filter((e=>r.has(e))),points:l}}(o,null!==r&&void 0!==r?r:5,null!==s&&void 0!==s?s:30,l)),[o,s,r,l]),y=i.useMemo((()=>{if(!b)return{};const e={};let t;return b.versions.forEach((n=>{const{hue:i,avoidToken:o}=function(e,t){var n;const i=a().xor4096(e);let o=0,s=0;if(t)for(let a=10;a>0;a--){let e=i();for(;v(e,t.adjacentHue)<.1||void 0!==t.adjacentHue2&&v(e,t.adjacentHue2)<.1;)e=i();let n=1;for(const i of t.allHues){const t=v(e,i);t<n&&(n=t)}n>s&&(o=e,s=n)}else o=i();return{hue:360*o,avoidToken:{adjacentHue:o,adjacentHue2:null===t||void 0===t?void 0:t.adjacentHue,allHues:[...null!==(n=null===t||void 0===t?void 0:t.allHues)&&void 0!==n?n:[],o]}}}(n,t);t=o,e[h?h(n):n]=i})),e}),[b,h]),B=i.useMemo((()=>b?b.versions.map((e=>{const t=h?h(e):e,n=y[t];return{name:t,hue:n,fill:d(n,{variant:null!==g&&void 0!==g&&g.isInverted?"dark":"light",targetLuminance:null!==g&&void 0!==g&&g.isInverted?"contrasts-light":"contrasts-dark"}),dataKey:e}})).reverse():[]),[b,null===g||void 0===g?void 0:g.isInverted,y,h]);return(0,C.jsxs)("div",{className:n,children:[(0,C.jsx)(T.h,{...x.responsiveContainer,children:(0,C.jsxs)(S.T,{...x.areaChart,data:null===b||void 0===b?void 0:b.points,reverseStackOrder:!0,stackOffset:"percentage"===m?"expand":"none",children:[(0,C.jsx)(M.K,{...x.xAxis,interval:(null!==(t=null===o||void 0===o?void 0:o.points.length)&&void 0!==t?t:0)/4,dataKey:"date",type:"number",scale:"time",domain:["dataMin","dataMax"],tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),(0,C.jsx)(H.B,{...x.yAxis,type:"number",..."percentage"===m?{domain:[0,1],tickFormatter:e=>`${Math.round(100*e)}%`}:{domain:["auto","auto"],tickFormatter:P}}),!1!==c&&(0,C.jsx)(w.u,{...x.tooltip,content:($={versionHues:y,unit:m,theme:p},e=>(0,C.jsx)(N,{...$,...e}))}),!1!==u&&k&&(0,C.jsx)(V.D,{height:0,content:e=>{let{payload:t}=e;return(0,A.createPortal)(t&&(0,C.jsx)(E,{payload:t,versionHues:y,hiddenSeries:j,setHiddenSeries:_}),k)}}),B.map((e=>{let{name:t,fill:n,dataKey:o}=e;return(0,i.createElement)(D.u,{...x.area,name:t,key:t,dataKey:e=>j.includes(h?h(o):o)?void 0:e.versionCounts[o],stackId:"1",fill:n,fillOpacity:1})})),(0,C.jsx)(I.q,{...x.grid})]})}),(0,C.jsx)("div",{ref:e=>L(null!==e&&void 0!==e?e:void 0)})]});var $}},5042:()=>{}}]);
//# sourceMappingURL=VersionDownloadChart.c8629189.chunk.js.map